<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>æ¸¯éµæ±æ¶Œç¶«é å ±åˆ°ç«™ç³»çµ±</title>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <style>
:root{
--blue1:#e3f2fd;
--blue2:#b3e5fc;
--accent:#1565c0;
--card:#ffffffee;
--muted:#546e7a;
}
body{
font-family:"PingFang HK","Microsoft JhengHei",Arial,sans-serif;
margin:0;padding:36px;
background:linear-gradient(135deg,var(--blue1),var(--blue2));
color:#123;
}
.wrap{max-width:980px;margin:0 auto;}
header{text-align:center;margin-bottom:18px;}
h1{margin:0;color:var(--accent);font-size:26px;}
.sub{color:var(--muted);margin-top:6px;font-size:14px;}
.topbar{display:flex;justify-content:space-between;align-items:center;gap:12px;margin:18px 0 22px 0;flex-wrap:wrap;}
form{background:var(--card);padding:12px 14px;border-radius:12px;box-shadow:0 6px 18px rgba(9,30,66,0.06);display:flex;gap:10px;align-items:center;min-width:320px;}
select{padding:8px 10px;border-radius:8px;border:1px solid #cfe8ff;font-size:14px;background:white;}
input[type="submit"]{padding:8px 12px;border-radius:8px;border:none;background:var(--accent);color:white;font-weight:600;cursor:pointer;}
#scheduleSection{margin-top:20px;display:none;gap:18px;align-items:flex-start;}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:18px;}
.card{background:var(--card);border-radius:12px;padding:14px;box-shadow:0 8px 20px rgba(9,30,66,0.06);min-height:120px;}
.card h3{margin:0 0 8px 0;color:var(--accent);font-size:16px;}
table{width:100%;border-collapse:collapse;font-size:14px;}
thead th{text-align:left;padding:8px 6px;background:linear-gradient(90deg,var(--accent),#0b63a6);color:white;font-weight:600;font-size:13px;}
tbody td{padding:10px 6px;border-bottom:1px dashed #e6f0fb;color:#0d2330;}
.small{font-size:12px;color:var(--muted);}
#backBtn{padding:6px 10px;border-radius:8px;border:none;background:#90caf9;color:white;cursor:pointer;margin-bottom:12px;}
@media(max-width:760px){.grid{grid-template-columns:1fr}form{width:100%;justify-content:space-between}}
</style>
</head>
  
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠŸèƒ½æ›´æ–° - MTR ETA</title>
    <style>
        /* é é¢åŸºæœ¬è¨­ç½® */
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: #f4f7f6; 
            margin: 0; 
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* å½ˆçª—é®ç½©å±¤ */
        .overlay { 
            position: fixed; 
            top: 0; left: 0; 
            width: 100%; height: 100%; 
            background: rgba(0, 0, 0, 0.6); 
            backdrop-filter: blur(4px); /* èƒŒæ™¯æ¨¡ç³Šæ•ˆæœï¼Œæ›´å…·ç¾ä»£æ„Ÿ */
            display: flex; 
            justify-content: center; 
            align-items: center; 
            z-index: 9999;
            visibility: hidden;
            opacity: 0;
            transition: all 0.3s ease-in-out;
        }
        .overlay.show { 
            visibility: visible; 
            opacity: 1; 
        }

        /* å½ˆçª—ä¸»é«” */
        .pop-card { 
            background: white; 
            padding: 30px; 
            border-radius: 16px; 
            width: 85%; 
            max-width: 420px; 
            text-align: center; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            transform: translateY(20px);
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .overlay.show .pop-card { 
            transform: translateY(0); 
        }

        /* æ–‡å­—å…§å®¹æ¨£å¼ */
        .icon { font-size: 50px; margin-bottom: 15px; }
        h2 { color: #007aff; margin: 0 0 15px 0; font-size: 24px; }
        p { 
            color: #4a4a4a; 
            line-height: 1.6; 
            font-size: 16px;
            margin-bottom: 25px;
            text-align: left; /* è®“è·¯ç·šç´°ç¯€è¼ƒæ˜“é–±è®€ */
        }
        .note {
            font-size: 13px;
            color: #8e8e93;
            border-top: 1px solid #eee;
            padding-top: 10px;
            margin-top: 15px;
        }

        /* æŒ‰éˆ•æ¨£å¼ */
        .btn { 
            background: #007aff; 
            color: white; 
            padding: 14px 0; 
            border: none; 
            border-radius: 12px; 
            font-size: 18px; 
            font-weight: bold;
            text-decoration: none; 
            display: block; 
            width: 100%;
            transition: background 0.2s;
        }
        .btn:hover { background: #0056b3; }

        /* é—œé–‰é€£çµ */
        .close-link {
            display: inline-block;
            margin-top: 15px;
            color: #8e8e93;
            font-size: 14px;
            cursor: pointer;
            text-decoration: underline;
        }
    </style>
</head>
<body>

    <p>æ­£åœ¨è¼‰å…¥ä¸»é é¢å…§å®¹...</p>

    <div class="overlay" id="updatePop">
        <div class="pop-card">
            <div class="icon">ğŸš†</div>
            <h2>å…¨æ–°åŠŸèƒ½ï¼Œç«‹å³ä½¿ç”¨å§ï¼</h2>
            <p>
                ç¾åœ¨å·²ç¶“æ”¯æ´å¤§éƒ¨ä»½å…¨æ¸¯æ¸¯éµè·¯ç·šåŠè»Šç«™ã€‚
                <br><br>
                <span style="color: #666;">å³æ™‚æŒæ¡åˆ°ç«™æ™‚é–“ï¼Œè¡Œç¨‹æ›´æœ‰é ç®—ï¼</span>
            </p>
            
            <a href="https://files.danielchan.idv.hk/eta/mtr.html" class="btn">ç«‹å³é«”é©—</a>
            
            <div class="note">
                * ä¸åŒ…æ‹¬è¿ªå£«å°¼ç¶«æ¬£æ¾³ç«™åŠè¿ªå£«å°¼ç«™
            </div>

            <span class="close-link" onclick="closePop()">ç¨å¾Œå†èªª</span>
        </div>
    </div>

    <script>
        const overlay = document.getElementById('updatePop');

        function openPop() {
            overlay.classList.add('show');
        }

        function closePop() {
            overlay.classList.remove('show');
        }

        // é é¢è¼‰å…¥ 1.2 ç§’å¾Œå½ˆå‡ºï¼Œå¢åŠ äº’å‹•æ„Ÿ
        window.onload = () => {
            setTimeout(openPop, 1200);
        };

        // é»æ“Šé®ç½©èƒŒæ™¯ä¹Ÿå¯ä»¥é—œé–‰
        overlay.onclick = function(e) {
            if (e.target === overlay) closePop();
        };
    </script>
</body>
</html>

<body>
<div class="wrap">
<header>
<h1>æ¸¯éµæ±æ¶Œç¶«é å ±åˆ°ç«™ç³»çµ±ï¼ˆæ¸¬è©¦ç‰ˆï¼‰</h1>
<div class="sub">è³‡æ–™ç”±<b>é¦™æ¸¯éµè·¯æœ‰é™å…¬å¸</b>æä¾›</div>
</header>
<div class="topbar">
<form id="stationForm">
<label for="stationSelect" class="small" style="margin-right:6px">è«‹é¸æ“‡è»Šç«™</label>
<select id="stationSelect" name="station">
<option value="">-- è«‹å•ä½ ç›®å‰åœ¨å“ªä¸€å€‹è»Šç«™ï¼Ÿ --</option>
<option value="TUC">æ±æ¶Œç«™</option>
<option value="SUN">æ¬£æ¾³ç«™</option>
<option value="TSY">é’è¡£ç«™</option>
<option value="LAK">è”æ™¯ç«™</option>
<option value="NAM">å—æ˜Œç«™</option>
<option value="OLY">å¥§é‹ç«™</option>
<option value="KOW">ä¹é¾ç«™</option>
<option value="HOK">é¦™æ¸¯ç«™</option>
</select>
<input type="submit" value="æŸ¥çœ‹ä¸‹ä¸€ç­åˆ—è»Š">
</form>
</div>
<div id="scheduleSection">
<button id="backBtn">â† è¿”å›ä¸Šä¸€é </button>
<h2 id="stationTitle">ç«™åˆ¥</h2>
<div class="grid">
<div class="card">
<h3>ä¸Šè¡Œï¼ˆå¾€æ±æ¶Œç«™æ–¹å‘ï¼‰</h3>
<table id="upTable">
<thead><tr><th></th><th>åˆ—è»Šçµ‚é»ç«™</th><th>æœˆå°</th><th>é è¨ˆåˆ°é”æ™‚é–“</th><th>å‰©é¤˜æ™‚é–“</th></tr></thead>
<tbody></tbody>
</table>
</div>
<div class="card">
<h3>ä¸‹è¡Œï¼ˆå¾€é¦™æ¸¯ç«™æ–¹å‘ï¼‰</h3>
<table id="downTable">
<thead><tr><th></th><th>åˆ—è»Šçµ‚é»ç«™</th><th>æœˆå°</th><th>é è¨ˆåˆ°é”æ™‚é–“</th><th>å‰©é¤˜æ™‚é–“</th></tr></thead>
<tbody></tbody>
</table>
</div>
</div>
<p class="small" style="margin-top:12px">ä¸Šè¿°è³‡æ–™åªä¾›åƒè€ƒï¼Œè³‡æ–™ç”±<b>é¦™æ¸¯éµè·¯æœ‰é™å…¬å¸</b>æä¾›ã€‚</p>
</div>
</div>
<script>
var upTrains=[],downTrains=[],tickInterval,stationCode='';
function pad(n){return n<10?'0'+n:n}
function parseTime(s){var p=s.split(/[- :]/).map(Number);return new Date(p[0],p[1]-1,p[2],p[3],p[4],p[5])}
function fmtHMS(d){return pad(d.getHours())+':'+pad(d.getMinutes())+':'+pad(d.getSeconds())}
function fmtTTNT(t){t=Number(t);if(!t||t<=0)return'å³å°‡åˆ°ç«™';var h=Math.floor(t/3600),m=Math.floor((t%3600)/60),s=t%60;return(h>0?h+'å°æ™‚ ':'')+(m>0?m+'åˆ†é˜ ':'')+s+'ç§’'}
function convertDest(d){var m={"HOK":"å¾€é¦™æ¸¯ç«™","KOW":"å¾€ä¹é¾ç«™","OLY":"å¾€å¥§é‹ç«™","NAM":"å¾€å—æ˜Œç«™","LAK":"å¾€è”æ™¯ç«™","TSY":"å¾€é’è¡£ç«™","SUN":"å¾€æ¬£æ¾³ç«™","TUC":"å¾€æ±æ¶Œç«™"};return m[d]||d}
function renderTables(){var up='';for(var i=0;i<upTrains.length;i++){var t=upTrains[i];up+='<tr><td>'+(t.seq||i+1)+'</td><td>'+convertDest(t.dest)+'</td><td>'+(t.plat||'-')+'</td><td>'+fmtHMS(t.time)+'</td><td id="'+t.id+'">'+fmtTTNT(Math.max(0,(t.time.getTime()-new Date().getTime())/1000|0))+'</td></tr>'}$('#upTable tbody').html(up);var down='';for(var j=0;j<downTrains.length;j++){var d=downTrains[j];down+='<tr><td>'+(d.seq||j+1)+'</td><td>'+convertDest(d.dest)+'</td><td>'+(d.plat||'-')+'</td><td>'+fmtHMS(d.time)+'</td><td id="'+d.id+'">'+fmtTTNT(Math.max(0,(d.time.getTime()-new Date().getTime())/1000|0))+'</td></tr>'}$('#downTable tbody').html(down)}
function updateTTNT(){for(var i=0;i<upTrains.length;i++){var t=upTrains[i];var remain=Math.max(0,(t.time.getTime()-new Date().getTime())/1000|0);$('#'+t.id).text(fmtTTNT(remain))}for(var j=0;j<downTrains.length;j++){var d=downTrains[j];var remain=Math.max(0,(d.time.getTime()-new Date().getTime())/1000|0);$('#'+d.id).text(fmtTTNT(remain))}}
function fetchData(code){var url='https://api.allorigins.win/get?url='+encodeURIComponent('https://rt.data.gov.hk/v1/transport/mtr/getSchedule.php?line=TCL&sta='+code+'&lang=ch');$.getJSON(url,function(res){var data=JSON.parse(res.contents).data['TCL-'+code]||{};var up=data.UP||[],down=data.DOWN||[];upTrains=up.map(function(t,i){return{id:'up-'+i,seq:t.seq,dest:t.dest,plat:t.plat,time:parseTime(t.time)}});downTrains=down.map(function(t,i){return{id:'down-'+i,seq:t.seq,dest:t.dest,plat:t.plat,time:parseTime(t.time)}});renderTables();clearInterval(tickInterval);tickInterval=setInterval(updateTTNT,1000);})}
$('#stationForm').on('submit',function(e){e.preventDefault();var code=$('#stationSelect').val();if(!code){alert('å“å‘€ï¼å¯èƒ½ä½ å¿˜è¨˜äº†é¸æ“‡è»Šç«™ï¼Œä½ éœ€è¦é¸æ“‡ä½ ç›®å‰çš„è»Šç«™ï¼Œæˆ‘å€‘æ‰èƒ½å¤ å‘ä½ æä¾›æ­£ç¢ºçš„é å ±ã€‚');return}stationCode=code;$('#stationTitle').text($('#stationSelect option:selected').text()+'ç«™é å ±åˆ°ç«™æ™‚é–“');$('#scheduleSection').show();fetchData(code)})
$('#backBtn').on('click',function(){$('#scheduleSection').hide();upTrains=[];downTrains=[];clearInterval(tickInterval);$('#upTable tbody').html('');$('#downTable tbody').html('');})
</script>
</body>
</html>
